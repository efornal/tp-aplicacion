%\documentclass[conference,spanish,a4paper,10pt,oneside,final]{IEEEtran}
\nonstopmode
\documentclass[conference,spanish,a4paper,10pt,oneside,final]{tfmpd}

\include{conf/preconfig}
\include{conf/packages}
%
% Propiedades del documento: título, autor, etc
%
%% \newcommand{\titulo}{{\large FICH --- UNL}\\Procesamiento Digital de Imágenes
%% 2010\\Trabajo Final}
%% \newcommand{\autor}{Fornal, Esteban \and Pfarher, Christian \and Torrez, Mauro}
%% \newcommand{\fecha}{\today}
%% \newcommand{\tituloPDF}{Trabajo Final PDI 2010}
%% \newcommand{\autorPDF}{Fornal, Pfarher, Torrez}
%% \newcommand{\asuntoPDF}{}
%% \newcommand{\clavesPDF}{}
%
\include{conf/config}
%\include{conf/comandos}
%
\begin{document}
\title{Identificación de edificios y monumentos a partir de fotografías
tomadas con dispositivos móviles}
\author{Esteban C. Fornal, Christian N. Pfarher, Mauro J. Torrez\\
\textit{Trabajo práctico final de ``Procesamiento Digital de
Imágenes'', II-FICH-UNL.}}
\markboth{Procesamiento Digital de Imágenes: TRABAJO FINAL}{}
\maketitle
%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
\begin{abstract}
%% El objetivo de este trabajo consiste en la identificación de edificios y
%% monumentos, a partir de imágenes obtenidas mediante un dispositivo móvil de
%% características estándar en el mercado. Para dicho propósito se plantearán
%% métodos diferentes, uno mediante extracción de características en el espacio
%% de la Transformada de Hough y otro basado en medidas estadísticas, comparando
%% a cada uno de ellos por separado y finalmente, evaluando el desempeño de la
%% utilización de ambos conjuntamente.
Se presenta un método para la identificación de edificios y monumentos, a
partir de fotografías tomadas con la cámara de un dispositivo móvil.
Para la identificación se extrae un vector de características de la imagen,
que es almacenado en una base de datos para su consulta.
Se presentan dos métodos para la extracción de características en la imagen, uno
basado en la transformada de Hough y otro que utiliza estadísticas de los
histogramas. Se evalúa el desempeño utilizando ambos métodos por separado y en
conjunto, para una base de datos de prueba de unas pocas imágenes.
\end{abstract}
%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
\begin{keywords}
Identificación/reconocimiento de edificios, \eng{building recognition},
histograma, extracción de características, transformada de Hough, clasificación.
\end{keywords}
%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
\section{Introducción}
\PARstart{L}{a} presencia de gran cantidad de dispositivos tecnológicos de
diferente índole ha abierto un sin número de nuevas aplicaciones para
satisfacer las necesidades diarias de seres humanos. Los dispositivos móviles
como celulares, PDAs, etc. han pasado a formar parte del común de nuestras
vidas brindando nuevas posibilidades de interacción. Es aquí donde surge la
idea de la realización de este trabajo. 

Día a día, las personas toman fotografías de diferentes objetos ya sean
monumentos públicos, edificios históricos, etc. sin saber si quiera que se
está fotografiando. Con este artículo se trata de hacer un aporte en vías
hacia dicho problema, de manera que mediante el procesamiento de imágenes se
tenga dicha información en el instante mismo de la adquisición de la foto.
Cabe aclarar, que se hará una implementación en C++, dejando como trabajo
futuro el desarrollo de una aplicación para dispositivos móviles.

En principio y ya que no es el objetivo de este trabajo hacer un análisis
profundo, sino tan solo dar una aproximación inicial a la resolución del
problema, se considerará la aplicación de los métodos en condiciones
ideales o semi-ideales. \resalt{ver...}
%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
\section{Método propuesto}
El método que proponemos se basa en la extracción de características de la
imagen y la comparación de éstas con las de una base de datos.
Esta base de datos se genera tomando $X$ imágenes representativas del monumento,
extrayendo sus características y promediándolas para obtener un prototipo
``generalizado'' del monumento/edificio a detectar.

La extracción de características se realiza en este trabajo mediante dos
técnicas diferentes:
\begin{enumerate}
\item extracción de características por transformada de Hough, y
\item extracción de características por estadísticas del histograma.
\end{enumerate}

El entrenamiento de la base de datos se realiza obteniendo las características
para cada imagen, junto con su etiqueta. Para cada etiqueta, se extraen las
características de las $X$ imágenes etiquetadas con la misma, y se guarda un
``prototipo'' obtenido de promediar estas características, junto con la
etiqueta.

La clasificación de las imágenes consiste en encontrar la etiqueta del
prototipo cuyas características minimicen el error cuadrático medio.

Sobre diez de las trece imágenes de cada edificio, se aplicó el método de la Transformada de Hough citado en este artículo, obteniéndose diez vectores representativos (uno por cada imagen) y se procedió a promediar dichos vectores dando como resultado un prototipo por cada edificio. De la misma manera se realizó el mismo proceso, con el método estadístico descripto también en este documento.

%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\subsection*{Extracción de características mediante Transformada de Hough}
La transformada de Hough nos permite visualizar, a partir de una imagen de
bordes, los parámetros de aquellas rectas\footnote{El procedimiento es general,
sirve para cualquier geometría que se pueda expresar en términos de sus
parámetros. En este trabajo, utilizamos el espacio de los parámetros de las
rectas, el más sencillo.}
que son principales en la imagen.

Para la extracción de características con esta técnica se siguen los siguientes
pasos:
\begin{enumerate}
\item A partir de la imagen original, se obtiene una versión en escala de grises
      promediando los tres canales RGB, y se la escala a un tamaño normalizado.
\item Se obtiene una imagen de sólo bordes, aproximando la magnitud del
      gradiente según
      \begin{equation}
      \label{sob}
      \nabla f \approx |G_x| + |G_y|,
      \end{equation}
      donde $G_x$, $G_y$ son el resultado de aplicar los operadores gradiente
      de Sobel (fig. \ref{masksobel}) a la imagen. 
      Finalmente se umbraliza esta imagen de bordes en $U$:
      \begin{equation}
      \label{umbral}
      f(x)=
      \begin{cases}
      0, & x\leq U\\
      255, & x > U
      \end{cases}
      \end{equation}
\item Con la imagen de bordes umbralizada se calcula la transformada de
      Hough para rectas.
\item Se aplica escalado a la transformada obtenida, llevándola a un tamaño
      pequeño buscando obtener mayor tolerancia tanto en el parámetro angular
      $\theta$ como de distancia $\rho$
\item Se toman $N$ máximos de esta transformada y se guardan en el vector de
      características las coordenadas $(\rho,\theta)$, mapeadas al rango
      $[-1,1]$ obteniendo así un vector de $2N$ valores.
\end{enumerate}
El proceso completo puede verse en la Fig. \ref{procesohough}.
%% Como se puede observar en la Fig. \ref{procesohough}, en el primer paso se
%% obtiene una imagen de un solo canal mediante el promediado de los tres
%% canales RGB. Luego, con el objetivo de disminuir el costo computacional, se
%% realiza un redimensionamiento de la imagen de 640 x 480 pixels a 100x100.
%% Posteriormente, para la detección de bordes se aplica el operador gradiente
%% de sobel (\ref{sob}) y se umbraliza con la función definida en
%% (\ref{umbral}).
\begin{figure}
\begin{center}
\begin{tabular}{|c|c|c|}
\hline -1 & -2 & -1 \\\hline 0 & 0 & 0 \\\hline 1 & 2 & 1 \\\hline
\end{tabular}
\begin{tabular}{|c|c|c|}
\hline -1 & 0 & 1 \\\hline -2 & 0 & 2 \\\hline -1 & 0 & 1 \\\hline
\end{tabular}
\end{center}
\caption{Máscaras de filtrado (operadores gradiente) de Sobel.}
\label{masksobel}
\end{figure}


%

%
%
%% Tras estos pasos, se transforma al espacio de Hough y aquí se aplica nuevamente un redimensionado a tamaño de 40x40 con el fin de tener una tolerancia respecto a $\rho$ y $\theta$ del espacio transformado de Hough.\resalt{no me gusta arreglar}
%% Finalmente, se obtienen las coordenadas $\rho$ y $\theta$ de 50 máximos con las cuales se forma el vector de características representativo de la imagen.
\begin{figure}
\begin{center}
\includegraphics[scale=0.25]{../diagramas/procesohough} 
\end{center}
\caption{Proceso de la imagen mediante el método por T. de Hough}
\label{procesoestadisticas}
\end{figure}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\subsection*{Extracción de características por estadísticas del histograma}
A partir de la imagen original, se normaliza su tamaño y se toman 2 ``perfiles de
intensidad'': uno horizontal, calculado promediando cada columna de la imagen, y
otro vertical obtenido al promediar cada fila. Se obtiene un histograma para la
imagen entera y uno para cada perfil, y se guardan en el vector de
características la media aritmética $m$, mediana $M$ (posición del percentil 50),
 y desviación absoluta $D_{\T{abs}}$ respecto de la mediana:
\begin{equation*}
D_{\T{abs}}=\sum_i |x_i - M|
\end{equation*}
Así se han obtenido un vector de 9 valores que caracterizan histogramas de la
imagen entera.

Luego se subdivide la imagen en cuatro cuadrantes, y se obtienen para cada uno
las mismas medidas que se calcularon para la imagen entera.

Así se obtiene un vector de 45 características a partir de histogramas que se
guardarán en la base de datos para comparación.

\begin{figure}
\begin{center}
\includegraphics[scale=0.25]{../diagramas/procesoestadisticas} 
\end{center}
\caption{"Proceso de la imagen mediante el método de estadísticas del histograma"}
\label{procesohough}
\end{figure}

%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\subsection*{}

%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
\section{Experimentos y resultados}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\subsection{Descripción de las pruebas}
Para la prueba del método se utilizó validación cruzada, entrenando la base de
datos con 10 imágenes por clase y 3 de prueba por cada clase. Se utilizaron
3 conjuntos de imágenes diferentes, con 5 clases cada uno.

Las imágenes de prueba fueron tomadas con teléfonos celulares corrientes, a una
resolución VGA estándar de 640 píxeles de ancho por 480 de alto, en
diferentes condiciones
de iluminación: día a pleno sol, día nublado, noche, e interior, a monumentos/%
estatuas y edificios en diferentes lugares de la ciudad de Santa Fe, Argentina.
Se muestran en la figura \ref{imagenes} algunos ejemplos.
Los conjuntos se formaron sorteando las 15 clases de imágenes disponibles en
3 de 5 clases cada uno.

Se probaron, en primer lugar, la extracción de características mediante
transformada de Hough y mediante histogramas por separado.

Para el método de Hough se probaron diferentes valores de $U$, el umbral
aplicado a la imagen de bordes, y $N$, el número de máximos en el espacio de
la transformada de Hough a tener en cuenta para armar el vector de $2N$
características.

Luego se consideró el rendimiento del método utilizando ambas técnicas en
forma conjunta, para los parámetros de Hough $U$ y $N$ óptimos encontrados.
Se realizó además una prueba para las 15 clases de imágenes en conjunto,
con el objetivo de tener una estimación de cómo escala el método para
mayor número de imágenes.

\subsubsection*{Tasa de error}
Se considera la tasa de error $\%$ del método según:
\begin{equation}
E_\%=100\cdot\frac{\T{número de errores}}{\T{número de pruebas}},
\end{equation}
considerando como error cada prueba en que la imagen es mal etiquetada.

Cabe observar que no se considera como error la vez que el método identifica
una imagen como el monumento acertado, pero en otras
condiciones de iluminación (cuando por ejemplo, la imagen de un monumento
tomada de día es clasificada como la del mismo monumento, pero tomada de noche).
Esta consideración se hace debido a que la detección de bordes elimina la
información de \resalt{luminosidad}  de la imagen; y está claro que no influye
en la clasificación por histograma; ya que éste varía significativamente
entre las versiones de día y noche, en particular, la media y mediana tendrán
valores bastante menores en la imagen nocturna que en aquella tomada de día.
Esto es además consistente con el objetivo del método, que es la correcta
identificación independientemente de las condiciones en que se toma la imagen.

%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
\subsection{Discusión}

\begin{table}
\caption{Tasas de error para métodos}
\begin{center}
\begin{tabular}{ccc}
\hline \emph{Método} & \emph{5 clases} & \emph{15 clases}\\ 
\hline Histogramas & 0\% & 0\%\\ 
\hline Hough & 35.5\% & 60.43\%\\ 
\hline Ambos & 2.22\% & 4.17\%\\ 
\hline 
\end{tabular} 
\end{center}
\end{table}
%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
\section{Conclusiones}
blablabla
%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
\section{Trabajos futuros}
A partir del diseño aquí presentado, seguiremos investigando esta técnica con las siguientes
posibilidades:
\begin{itemize}
\item Considerar la aplicación de un filtrado homomórfico en imágenes que lo requieran.
\item Independizarse de la posición en que se tomó la fotografía con alguna técnica de warping.
\item Arreglar el metodo de Hough que es una X onga jaja\end{itemize}

\nocite{*}
\bibliographystyle{tfmpd}
\bibliography{tfmpd}
\end{document}

